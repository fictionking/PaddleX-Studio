<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Hue Corrected Color Picker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        neutral: '#64748B',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'elevation-1': '0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)',
                        'elevation-2': '0 3px 6px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.12)',
                    }
                },
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .color-transition {
                transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
            }
            .transform-transition {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            /* 色相渐变 - 从上到下按色相值递增排列 */
            .hue-gradient {
                background: linear-gradient(
                    to bottom,
                    #ff0000, #ffff00, #00ff00, 
                    #00ffff, #0000ff, #ff00ff, #ff0000
                );
            }
            /* 饱和度渐变 */
            .saturation-gradient {
                background: linear-gradient(to bottom, currentColor, #808080);
            }
            /* 亮度渐变 */
            .lightness-gradient {
                background: linear-gradient(to bottom, #ffffff, currentColor, #000000);
            }
            /* 垂直滑块样式 */
            input[type=range][orient=vertical] {
                writing-mode: bt-lr; /* IE */
                -webkit-appearance: slider-vertical; /* Chromium */
                width: 8px;
                height: 100%;
                padding: 0 5px;
            }
            /* 颜色圆盘标记 */
            .wheel-marker {
                width: 14px;
                height: 14px;
                border: 2px solid white;
                border-radius: 50%;
                box-shadow: 0 0 0 1px rgba(0,0,0,0.3);
                transform: translate(-50%, -50%);
                pointer-events: none;
            }
            /* 滑块长条标记 */
            .slider-bar-marker {
                width: 100%;
                height: 4px;
                left: 0;
                border-radius: 2px;
                border: 1px solid rgba(0,0,0,0.2);
                background-color: white;
                transform: translateY(-50%);
                pointer-events: none;
            }
        }
    </style>
</head>
<body class="font-inter bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <!-- 主容器 -->
    <div class="bg-white rounded-xl shadow-elevation-2 w-full max-w-md overflow-hidden transform-transition">
        <!-- 标题栏 -->
        <div class="px-4 py-3 border-b border-gray-100 flex justify-between items-center">
            <h1 class="text-sm font-semibold text-dark">Color Picker</h1>
            <button id="close-btn" class="text-gray-400 hover:text-dark color-transition text-xs">
                <i class="fa fa-times"></i>
            </button>
        </div>
        
        <!-- 主要颜色选择区域 -->
        <div class="px-4 py-3 flex flex-col md:flex-row gap-4">
            <!-- 彩色圆盘 -->
            <div class="flex-1 flex justify-center">
                <div id="color-wheel" class="relative w-[200px] h-[200px] rounded-full overflow-hidden shadow-inner">
                    <!-- 颜色圆盘将通过JS生成 -->
                    <div id="wheel-marker" class="wheel-marker absolute hidden"></div>
                </div>
            </div>
            
            <!-- 三个垂直滑块 -->
            <div class="flex gap-2">
                <!-- 色相滑块 -->
                <div class="flex flex-col items-center w-6">
                    <label class="text-xs text-gray-500 mb-1.5 block text-center">Hue</label>
                    <div class="relative h-[200px] rounded-lg overflow-hidden w-full">
                        <div class="absolute inset-0 hue-gradient"></div>
                        <input type="range" id="hue-slider" min="0" max="360" value="217" orient="vertical" class="absolute inset-0 opacity-0 cursor-pointer">
                        <div id="hue-marker" class="slider-bar-marker absolute" style="top: 45%"></div>
                    </div>
                    <span class="text-xs text-gray-500 mt-1" id="hue-value">217°</span>
                </div>
                
                <!-- 饱和度滑块 -->
                <div class="flex flex-col items-center w-6">
                    <label class="text-xs text-gray-500 mb-1.5 block text-center">Saturation</label>
                    <div class="relative h-[200px] rounded-lg overflow-hidden w-full">
                        <div class="absolute inset-0 saturation-gradient" id="saturation-gradient"></div>
                        <input type="range" id="saturation-slider" min="0" max="100" value="100" orient="vertical" class="absolute inset-0 opacity-0 cursor-pointer">
                        <div id="saturation-marker" class="slider-bar-marker absolute" style="top: 0%"></div>
                    </div>
                    <span class="text-xs text-gray-500 mt-1" id="saturation-value">100%</span>
                </div>
                
                <!-- 亮度滑块 -->
                <div class="flex flex-col items-center w-6">
                    <label class="text-xs text-gray-500 mb-1.5 block text-center">Lightness</label>
                    <div class="relative h-[200px] rounded-lg overflow-hidden w-full">
                        <div class="absolute inset-0 lightness-gradient" id="lightness-gradient"></div>
                        <input type="range" id="lightness-slider" min="0" max="100" value="50" orient="vertical" class="absolute inset-0 opacity-0 cursor-pointer">
                        <div id="lightness-marker" class="slider-bar-marker absolute" style="top: 50%"></div>
                    </div>
                    <span class="text-xs text-gray-500 mt-1" id="lightness-value">50%</span>
                </div>
            </div>
        </div>
        
        <!-- 颜色预览和输入区 -->
        <div class="px-4 pb-3">
            <div id="color-preview" class="w-full h-16 rounded-lg shadow-inner bg-primary relative overflow-hidden mb-3">
                <div class="absolute inset-0 bg-gradient-to-tr from-transparent to-white/20"></div>
            </div>
            
            <div class="grid grid-cols-3 gap-2 mb-4">
                <div class="relative">
                    <label class="text-xs text-gray-500 mb-1 block">HEX</label>
                    <div class="flex">
                        <input type="text" id="hex-input" value="#3B82F6" class="w-full px-2 py-1.5 border border-gray-200 rounded-l-lg focus:outline-none focus:ring-1.5 focus:ring-primary/50 text-xs" />
                        <button class="copy-btn bg-gray-100 hover:bg-gray-200 px-2 rounded-r-lg color-transition text-xs" data-target="hex-input">
                            <i class="fa fa-copy text-gray-500"></i>
                        </button>
                    </div>
                </div>
                <div class="relative">
                    <label class="text-xs text-gray-500 mb-1 block">RGB</label>
                    <div class="flex">
                        <input type="text" id="rgb-input" value="rgb(59, 130, 246)" class="w-full px-2 py-1.5 border border-gray-200 rounded-l-lg focus:outline-none focus:ring-1.5 focus:ring-primary/50 text-xs" />
                        <button class="copy-btn bg-gray-100 hover:bg-gray-200 px-2 rounded-r-lg color-transition text-xs" data-target="rgb-input">
                            <i class="fa fa-copy text-gray-500"></i>
                        </button>
                    </div>
                </div>
                <div class="relative">
                    <label class="text-xs text-gray-500 mb-1 block">HSL</label>
                    <div class="flex">
                        <input type="text" id="hsl-input" value="hsl(217, 90%, 58%)" class="w-full px-2 py-1.5 border border-gray-200 rounded-l-lg focus:outline-none focus:ring-1.5 focus:ring-primary/50 text-xs" />
                        <button class="copy-btn bg-gray-100 hover:bg-gray-200 px-2 rounded-r-lg color-transition text-xs" data-target="hsl-input">
                            <i class="fa fa-copy text-gray-500"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Alpha (透明度) 控制 -->
            <div>
                <div class="flex justify-between mb-1.5">
                    <label class="text-xs text-gray-500">Alpha</label>
                    <span class="text-xs text-gray-500" id="alpha-value">100%</span>
                </div>
                <div class="relative h-5 rounded-lg overflow-hidden">
                    <div id="alpha-slider-bg" class="absolute inset-0 bg-gradient-to-r from-transparent via-primary to-primary"></div>
                    <input type="range" id="alpha-slider" min="0" max="100" value="100" class="w-full h-full opacity-0 cursor-pointer">
                    <div id="alpha-marker" class="slider-bar-marker absolute h-5" style="top: 50%; left: 100%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-500">
                    <span>0%</span>
                    <span>50%</span>
                    <span>100%</span>
                </div>
            </div>
        </div>
        
        <!-- 最近使用的颜色 -->
        <div class="px-4 pb-4 border-t border-gray-100 pt-3">
            <h3 class="text-xs font-medium text-gray-700 mb-2">Recent</h3>
            <div id="recent-colors" class="flex flex-wrap gap-1.5">
                <div class="recent-color w-6 h-6 rounded-full cursor-pointer transform-transition hover:scale-110 border border-gray-200" style="background-color: #EF4444"></div>
                <div class="recent-color w-6 h-6 rounded-full cursor-pointer transform-transition hover:scale-110 border border-gray-200" style="background-color: #10B981"></div>
                <div class="recent-color w-6 h-6 rounded-full cursor-pointer transform-transition hover:scale-110 border border-gray-200" style="background-color: #F59E0B"></div>
                <div class="recent-color w-6 h-6 rounded-full cursor-pointer transform-transition hover:scale-110 border border-gray-200" style="background-color: #8B5CF6"></div>
                <div class="recent-color w-6 h-6 rounded-full cursor-pointer transform-transition hover:scale-110 border border-gray-200" style="background-color: #EC4899"></div>
                <div class="recent-color w-6 h-6 rounded-full cursor-pointer transform-transition hover:scale-110 border border-gray-200" style="background-color: #64748B"></div>
                <div class="w-6 h-6 rounded-full border border-dashed border-gray-300 flex items-center justify-center text-gray-400 text-xs cursor-pointer hover:border-gray-400 color-transition">
                    <i class="fa fa-plus"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- 复制成功提示 -->
    <div id="copy-toast" class="fixed top-4 right-4 bg-dark text-white px-3 py-1.5 rounded-lg shadow-elevation-2 opacity-0 transition-opacity duration-300 pointer-events-none text-xs">
        <span>Copied!</span>
    </div>

    <script>
        // 颜色转换工具函数
        const ColorUtils = {
            // HSL 转 RGB
            hslToRgb: (h, s, l) => {
                s /= 100;
                l /= 100;
                
                let r, g, b;
                
                if (s === 0) {
                    r = g = b = l; // 灰色
                } else {
                    const hue2rgb = (p, q, t) => {
                        if (t < 0) t += 1;
                        if (t > 1) t -= 1;
                        if (t < 1/6) return p + (q - p) * 6 * t;
                        if (t < 1/2) return q;
                        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                        return p;
                    };
                    
                    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                    const p = 2 * l - q;
                    
                    r = hue2rgb(p, q, h / 360 + 1/3);
                    g = hue2rgb(p, q, h / 360);
                    b = hue2rgb(p, q, h / 360 - 1/3);
                }
                
                return {
                    r: Math.round(r * 255),
                    g: Math.round(g * 255),
                    b: Math.round(b * 255)
                };
            },
            
            // RGB 转 HEX
            rgbToHex: (r, g, b) => {
                return `#${[r, g, b]
                    .map(x => Math.round(x).toString(16).padStart(2, '0'))
                    .join('')
                    .toUpperCase()}`;
            },
            
            // RGB 转 HSL
            rgbToHsl: (r, g, b) => {
                r /= 255;
                g /= 255;
                b /= 255;
                
                const max = Math.max(r, g, b);
                const min = Math.min(r, g, b);
                let h, s, l = (max + min) / 2;
                
                if (max === min) {
                    h = s = 0; // 灰色
                } else {
                    const d = max - min;
                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                    
                    switch (max) {
                        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                        case g: h = (b - r) / d + 2; break;
                        case b: h = (r - g) / d + 4; break;
                    }
                    
                    h *= 60;
                }
                
                return {
                    h: Math.round(h),
                    s: Math.round(s * 100),
                    l: Math.round(l * 100)
                };
            },
            
            // HEX 转 RGB
            hexToRgb: (hex) => {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            },
            
            // 从圆盘位置计算HSL颜色
            positionToHsl: (x, y, centerX, centerY, radius) => {
                const dx = x - centerX;
                const dy = centerY - y;
                const distance = Math.min(Math.sqrt(dx * dx + dy * dy), radius);
                // 修正色相角度计算，使圆盘与滑块保持一致
                const angle = (Math.atan2(-dy, dx) * 180 / Math.PI + 360) % 360;
                
                return {
                    h: angle,
                    s: (distance / radius) * 100,
                    l: 50
                };
            },
            
            // 从HSL计算圆盘位置
            hslToPosition: (h, s, centerX, centerY, radius) => {
                const radians = h * Math.PI / 180;
                const distance = (s / 100) * radius;
                
                // 修正Y轴方向，使圆盘与滑块保持一致
                return {
                    x: centerX + distance * Math.cos(radians),
                    y: centerY - distance * Math.sin(-radians)
                };
            }
        };

        // 创建颜色圆盘
        function createColorWheel(element) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const size = Math.min(element.clientWidth, element.clientHeight);
            const scale = 2;
            canvas.width = size * scale;
            canvas.height = size * scale;
            canvas.style.width = `${size}px`;
            canvas.style.height = `${size}px`;
            element.appendChild(canvas);
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2;
            
            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const pixels = imageData.data;
            
            for (let y = 0; y < canvas.height; y++) {
                for (let x = 0; x < canvas.width; x++) {
                    const dx = x - centerX;
                    const dy = centerY - y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance <= radius) {
                        // 修正色相角度，使圆盘与滑块方向一致
                        const angle = (Math.atan2(-dy, dx) * 180 / Math.PI + 360) % 360;
                        const saturation = Math.min(100, (distance / radius) * 100);
                        const lightness = 50;
                        
                        const rgb = ColorUtils.hslToRgb(angle, saturation, lightness);
                        const index = (y * canvas.width + x) * 4;
                        pixels[index] = rgb.r;
                        pixels[index + 1] = rgb.g;
                        pixels[index + 2] = rgb.b;
                        pixels[index + 3] = 255;
                    }
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
            ctx.filter = 'blur(1px)';
            ctx.drawImage(canvas, 0, 0);
            ctx.filter = 'none';
            
            return { 
                canvas, 
                centerX: centerX / scale,
                centerY: centerY / scale,
                radius: radius / scale
            };
        }

        // 颜色选择器主逻辑
        document.addEventListener('DOMContentLoaded', () => {
            const colorWheel = document.getElementById('color-wheel');
            const wheelData = createColorWheel(colorWheel);
            const wheelMarker = document.getElementById('wheel-marker');
            
            // DOM 元素
            const hueSlider = document.getElementById('hue-slider');
            const hueMarker = document.getElementById('hue-marker');
            const hueValue = document.getElementById('hue-value');
            
            const saturationSlider = document.getElementById('saturation-slider');
            const saturationMarker = document.getElementById('saturation-marker');
            const saturationValue = document.getElementById('saturation-value');
            const saturationGradient = document.getElementById('saturation-gradient');
            
            const lightnessSlider = document.getElementById('lightness-slider');
            const lightnessMarker = document.getElementById('lightness-marker');
            const lightnessValue = document.getElementById('lightness-value');
            const lightnessGradient = document.getElementById('lightness-gradient');
            
            const alphaSlider = document.getElementById('alpha-slider');
            const alphaMarker = document.getElementById('alpha-marker');
            const alphaValue = document.getElementById('alpha-value');
            
            const colorPreview = document.getElementById('color-preview');
            const hexInput = document.getElementById('hex-input');
            const rgbInput = document.getElementById('rgb-input');
            const hslInput = document.getElementById('hsl-input');
            
            const copyBtns = document.querySelectorAll('.copy-btn');
            const copyToast = document.getElementById('copy-toast');
            const recentColors = document.querySelectorAll('.recent-color');

            // 当前颜色状态
            let currentColor = {
                h: 217,    // 色相
                s: 100,    // 饱和度
                l: 50,     // 亮度
                a: 100     // 透明度
            };

            // 更新颜色显示
            const updateColorDisplay = () => {
                const { h, s, l, a } = currentColor;
                const rgb = ColorUtils.hslToRgb(h, s, l);
                const hex = ColorUtils.rgbToHex(rgb.r, rgb.g, rgb.b);
                
                colorPreview.style.backgroundColor = `hsla(${h}, ${s}%, ${l}%, ${a / 100})`;
                
                hexInput.value = hex;
                rgbInput.value = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
                hslInput.value = `hsl(${h}, ${s}%, ${l}%)`;
                
                hueValue.textContent = `${h}°`;
                saturationValue.textContent = `${s}%`;
                lightnessValue.textContent = `${l}%`;
                alphaValue.textContent = `${a}%`;
                
                const hueColor = ColorUtils.hslToRgb(h, 100, 50);
                const hueHex = ColorUtils.rgbToHex(hueColor.r, hueColor.g, hueColor.b);
                
                saturationGradient.style.color = hueHex;
                lightnessGradient.style.color = hueHex;
                
                updateMarkerPositions();
            };

            // 更新标记位置 - 最终色相修正
            const updateMarkerPositions = () => {
                const { h, s, l, a } = currentColor;
                
                // 色相标记 - 彻底修正方向问题
                // 色相值增大 → 滑块向下移动，与渐变方向完全一致
                const huePercent = (h / 360) * 100;
                hueMarker.style.top = `${huePercent}%`;
                
                // 饱和度标记
                const saturationPercent = 100 - s;
                saturationMarker.style.top = `${saturationPercent}%`;
                
                // 亮度标记
                const lightnessPercent = 100 - l;
                lightnessMarker.style.top = `${lightnessPercent}%`;
                
                // 透明度标记
                const alphaPercent = a;
                alphaMarker.style.left = `${alphaPercent}%`;
                
                // 颜色圆盘标记
                const pos = ColorUtils.hslToPosition(
                    h, s, 
                    wheelData.centerX, wheelData.centerY, 
                    wheelData.radius
                );
                wheelMarker.style.left = `${pos.x}px`;
                wheelMarker.style.top = `${pos.y}px`;
                wheelMarker.style.display = 'block';
                wheelMarker.style.borderColor = l > 50 ? 'black' : 'white';
            };

            // 处理颜色圆盘交互
            let isDraggingWheel = false;
            
            const handleWheelInteraction = (clientX, clientY) => {
                const rect = wheelData.canvas.getBoundingClientRect();
                const x = clientX - rect.left;
                const y = clientY - rect.top;
                
                const hsl = ColorUtils.positionToHsl(
                    x, y, 
                    wheelData.centerX, wheelData.centerY, 
                    wheelData.radius
                );
                
                currentColor.h = Math.round(hsl.h);
                currentColor.s = Math.round(hsl.s);
                
                hueSlider.value = currentColor.h;
                saturationSlider.value = currentColor.s;
                
                updateColorDisplay();
            };

            colorWheel.addEventListener('mousedown', (e) => {
                isDraggingWheel = true;
                handleWheelInteraction(e.clientX, e.clientY);
            });

            document.addEventListener('mousemove', (e) => {
                if (isDraggingWheel) {
                    handleWheelInteraction(e.clientX, e.clientY);
                }
            });

            document.addEventListener('mouseup', () => {
                isDraggingWheel = false;
            });

            // 触摸设备支持
            colorWheel.addEventListener('touchstart', (e) => {
                isDraggingWheel = true;
                const touch = e.touches[0];
                handleWheelInteraction(touch.clientX, touch.clientY);
                e.preventDefault();
            });

            document.addEventListener('touchmove', (e) => {
                if (isDraggingWheel) {
                    const touch = e.touches[0];
                    handleWheelInteraction(touch.clientX, touch.clientY);
                    e.preventDefault();
                }
            });

            document.addEventListener('touchend', () => {
                isDraggingWheel = false;
            });

            // 色相滑块事件 - 关键修正
            hueSlider.addEventListener('input', (e) => {
                // 直接使用滑块值，不再反转，确保值与位置一致
                currentColor.h = 360-parseInt(e.target.value);
                updateColorDisplay();
            });

            // 饱和度滑块事件
            saturationSlider.addEventListener('input', (e) => {
                currentColor.s = parseInt(e.target.value);
                updateColorDisplay();
            });

            // 亮度滑块事件
            lightnessSlider.addEventListener('input', (e) => {
                currentColor.l = parseInt(e.target.value);
                updateColorDisplay();
            });

            // 透明度滑块事件
            alphaSlider.addEventListener('input', (e) => {
                currentColor.a = parseInt(e.target.value);
                updateColorDisplay();
            });

            // 输入框事件处理
            hexInput.addEventListener('blur', (e) => {
                const rgb = ColorUtils.hexToRgb(e.target.value);
                if (rgb) {
                    const hsl = ColorUtils.rgbToHsl(rgb.r, rgb.g, rgb.b);
                    currentColor.h = hsl.h;
                    currentColor.s = hsl.s;
                    currentColor.l = hsl.l;
                    
                    hueSlider.value = hsl.h;
                    saturationSlider.value = hsl.s;
                    lightnessSlider.value = hsl.l;
                    
                    updateColorDisplay();
                } else {
                    updateColorDisplay();
                }
            });

            rgbInput.addEventListener('blur', (e) => {
                const match = e.target.value.match(/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);
                if (match) {
                    const r = parseInt(match[1]);
                    const g = parseInt(match[2]);
                    const b = parseInt(match[3]);
                    
                    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {
                        const hsl = ColorUtils.rgbToHsl(r, g, b);
                        currentColor.h = hsl.h;
                        currentColor.s = hsl.s;
                        currentColor.l = hsl.l;
                        
                        hueSlider.value = hsl.h;
                        saturationSlider.value = hsl.s;
                        lightnessSlider.value = hsl.l;
                        
                        updateColorDisplay();
                        return;
                    }
                }
                updateColorDisplay();
            });

            hslInput.addEventListener('blur', (e) => {
                const match = e.target.value.match(/^hsl\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)$/);
                if (match) {
                    const h = parseInt(match[1]);
                    const s = parseInt(match[2]);
                    const l = parseInt(match[3]);
                    
                    if (h >= 0 && h <= 360 && s >= 0 && s <= 100 && l >= 0 && l <= 100) {
                        currentColor.h = h;
                        currentColor.s = s;
                        currentColor.l = l;
                        
                        hueSlider.value = h;
                        saturationSlider.value = s;
                        lightnessSlider.value = l;
                        
                        updateColorDisplay();
                        return;
                    }
                }
                updateColorDisplay();
            });

            // 复制按钮功能
            copyBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetId = btn.getAttribute('data-target');
                    const targetInput = document.getElementById(targetId);
                    
                    targetInput.select();
                    document.execCommand('copy');
                    
                    copyToast.style.opacity = '1';
                    setTimeout(() => {
                        copyToast.style.opacity = '0';
                    }, 2000);
                });
            });

            // 最近使用的颜色点击事件
            recentColors.forEach(colorEl => {
                colorEl.addEventListener('click', () => {
                    const color = colorEl.style.backgroundColor;
                    if (color) {
                        const match = color.match(/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/);
                        if (match) {
                            const r = parseInt(match[1]);
                            const g = parseInt(match[2]);
                            const b = parseInt(match[3]);
                            
                            const hsl = ColorUtils.rgbToHsl(r, g, b);
                            currentColor.h = hsl.h;
                            currentColor.s = hsl.s;
                            currentColor.l = hsl.l;
                            
                            hueSlider.value = hsl.h;
                            saturationSlider.value = hsl.s;
                            lightnessSlider.value = hsl.l;
                            
                            updateColorDisplay();
                        }
                    }
                });
            });

            // 初始化
            updateColorDisplay();
        });
    </script>
</body>
</html>
